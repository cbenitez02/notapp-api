image: node:22

definitions:
  steps:
    - step: &install
        name: 'âš™ï¸ Install Dependencies'
        caches:
          - node
        script:
          - npm ci

    - step: &lint
        name: 'ğŸ–Œï¸ Linter'
        caches:
          - node
        script:
          - npm run lint

    - step: &test
        name: 'ğŸ§ª Run Tests'
        caches:
          - node
        script:
          - npm run test:unit
          - npm run check:types

    - step: &build
        name: 'ğŸ”¨ Build Project'
        caches:
          - node
        script:
          - npm run build

pipelines:
  branches:
    '**':
      - step: *install
      - step: *lint
      - step: *test
      - step: *build

    master:
      - step: *install
      - step: *lint
      - step: *test
      - step: *build

  pull-requests:
    '**':
      - step: *install
      - step: *lint
      - step: *test
      - step: *build
